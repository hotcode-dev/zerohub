---
description: 'Astro development standards and best practices for content-driven websites'
applyTo: '**/*.astro, **/*.ts, **/*.js, **/*.md, **/*.mdx'
---

# Astro / Starlight Documentation Instructions

Project-specific guidelines for the ZeroHub docs site (`/docs`), built with Astro + Starlight. Focus on adding and maintaining high-quality documentation for the WebRTC signaling server and SDK.

## Stack & Structure
- Uses `@astrojs/starlight` integration (see `docs/astro.config.mjs`).
- Single content collection defined in `src/content.config.ts` with `docsLoader()` and `docsSchema()`.
- Source docs live in `docs/src/content/docs/` (`.md` / `.mdx`). Frontmatter drives routing & metadata.
- Sidebar sections configured explicitly in `astro.config.mjs` (`Guides`, `API Reference (autogenerate)`).
- Custom styling via Tailwind layer file: `src/styles/tailwind.css` (added as `customCss`).
- Header component override at `src/components/overrides/Header.astro`.

## Adding Documentation Pages
1. Create a file under `docs/src/content/docs/` (e.g. `guides/hub-types.md`).
2. Include required frontmatter:
```md
---
title: Hub Types
description: Compare static, random, and IP-based hubs
---
```
3. For hero/splash pages (like `index.mdx`), you can add extra frontmatter keys (`template: splash`, `hero:` block). Reuse existing structure.
4. Update sidebar if it is NOT under the autogenerated `api-reference` tree:
   - Edit `astro.config.mjs` and add `{ label: "Hub Types", slug: "guides/hub-types" }` inside the appropriate `items` array.
5. Use relative links: `[Start](../get-started/)` or `[ZeroHubClient](../../api-reference/client/)`.

## API Reference Section
- Autogenerated via `autogenerate: { directory: "api-reference" }` in `astro.config.mjs`.
- Place files under `docs/src/content/docs/api-reference/` and Starlight builds sidebar entries automatically—do NOT manually register them.
- Keep filenames kebab-case; route path mirrors directory structure.

## MDX & Components
- Prefer Markdown; switch to `.mdx` only when embedding components or dynamic code examples.
- You can import and use Starlight/Markdown components (admonitions, tables). For custom Svelte islands only where interactivity is essential.
- Avoid heavy client hydration—documentation should remain mostly static.

## Frontmatter Conventions
- `title` (required): Single H1-level concept.
- `description`: Short sentence (<= 120 chars) used in meta tags & summaries.
- Optional keys: `template`, `hero`, `badge`, `draft: true` for WIP pages.
- Do not duplicate the page `title` as a first-level heading; Starlight renders it automatically.

## Writing Style
- Focus on actionable explanations: show a minimal `ZeroHubClient` snippet early.
- Use ordered steps for workflows (e.g. hub creation, proto regeneration).
- Show command blocks using fenced `bash` snippets—one command per line.
- Clarify peer lifecycle with concise tables or bullet lists (avoid long narrative paragraphs).

## Code Examples
### SDK Initialization
```ts
import { ZeroHubClient, LogLevel } from '@zero-hub/client';
const client = new ZeroHubClient(['localhost:8080'], { tls: false, logLevel: LogLevel.Debug });
client.createHub('demo-hub');
```
### Multiple Data Channels
```ts
dataChannelConfig: {
  numberOfChannels: 3,
  onDataChannel: (peer, dc) => {
    if (dc.label === 'data-2') dc.onmessage = (e) => handleFileChunk(e.data);
  }
}
```
Keep examples runnable; omit unrelated logging boilerplate.

## Tailwind & Theming
- Theme customization lives in `src/styles/tailwind.css`; use `@theme` variables for palette changes.
- Dark mode accent swap handled via `[data-theme="dark"]` rules—preserve this pattern when extending.
- Avoid inline styles; prefer CSS variables defined in the theme layer.

## Overrides & Extensibility
- Global header modifications belong in `src/components/overrides/Header.astro`—keep logic minimal (branding, links).
- To add new global components (e.g. footer), register through `components:` in `astro.config.mjs`.
- Keep integration list lean; prefer content-side enhancements before adding plugins.

## Sidebar Hygiene
- Group related guides logically; avoid single-item groups.
- Use concise labels (2–3 words). Slug must match file relative path without extension.
- Remove obsolete entries promptly to prevent broken links.

## Performance & Build
- Docs site is static—avoid unnecessary client directives.
- Large code blocks: prefer collapsing with a short intro and keep under ~80 lines.
- Images: place in `src/assets/`; reference via relative paths. Use SVG for diagrams where possible.

## Common Pitfalls
1. Forgetting to update sidebar after adding a guide (page builds but is orphaned). 
2. Using hero frontmatter on non-splash pages—keep hero only on landing/index.
3. Hydrating interactive components without need—check if plain Markdown suffices.
4. Editing autogenerated API reference manually—changes will be overwritten.

## Workflow Commands
```bash
cd docs
npm install         # first-time setup
npm run dev         # local server (default :4321)
npm run build       # production build -> dist/
npm run preview     # serve built output
```

## Contribution Checklist
- New page added under correct directory.
- Frontmatter includes `title` + `description`.
- Sidebar updated if needed.
- Code samples tested (compile or conceptual correctness).
- Links validated (no 404 in local preview).
- No unnecessary client hydration.

Keep instructions focused on ZeroHub documentation—avoid generic Astro guidance unless required for this project.
